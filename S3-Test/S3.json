{
  "AWSTemplateFormatVersion": "2010-09-09",

  "Metadata" : {
    "AWS::CloudFormation::Interface" : {
      "ParameterGroups" : [
        {
          "Label" : { "default" : "S3 Configuration" },
          "Parameters" : [ "BucketName", "EnvType"]
        }
      ],
      "ParameterLabels" : {
        "BucketName" : { "default" : "Which name would you give to your bucket?" },
        "EnvType" : { "default" : "Specify environment" }
      }
    }
  },
  "Parameters": {
    "BucketName": {
        "Description": "a name without particuliar sign",
        "Type": "String",
        "AllowedPattern": "(?=^.{3,63}$)(?!^(\\d+\\.)+\\d+$)(^(([a-z0-9]|[a-z0-9][a-z0-9\\-]*[a-z0-9])\\.)*([a-z0-9]|[a-z0-9][a-z0-9\\-]*[a-z0-9])$)",
        "ConstraintDescription": "probleme avec la convention de nommage"
    },
    "EnvType" : {
      "Description" : "Environment type.",
      "Default" : "test",
      "Type" : "String",
      "AllowedValues" : ["prod", "dev", "test", "preprod"],
      "ConstraintDescription" : "must specify prod, dev, preprod or test."
    }
 },
 "Conditions" : {
  "CreateProdResources" : {"Fn::Equals" : [{"Ref" : "EnvType"}, "prod"]},
  "CreateDevResources" : {"Fn::Equals" : [{"Ref" : "EnvType"}, "dev"]}
},
  "Resources": {
      "Bucket": {
          "Type": "AWS::S3::Bucket",
          "Properties": {
              "BucketName" : {"Fn::Join":["-", [{"Ref":"BucketName"}, "prod"]]},              
              "AccessControl": "PublicRead"
          }
      }
  },
   "Outputs" : {
    "BucketARN":{
        "Description" : "the arn of the resource",
        "Value" : { "Fn::GetAtt" : [ "Bucket", "Arn" ]}

  }
 }
}

